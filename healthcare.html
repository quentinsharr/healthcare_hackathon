<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>QAAuckHUB Healthcare</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link href="healthstyles.css" rel="stylesheet">
  
  <script type="module">

    import { GoogleGenerativeAI } from "https://esm.run/@google/generative-ai";

    // Replace 'YOUR_API_KEY' with your actual Gemini API key
    const API_KEY = "AIzaSyBqZ4uSsnutN0-3Vt75QgRy4cfJCVrxKGY";
    const genAI = new GoogleGenerativeAI(API_KEY);

    async function get_ai_response(promptText)
    {

      try
      {
        const model = genAI.getGenerativeModel({ model: "gemini-1.5-pro-002" });
        const result = await model.generateContent(promptText);
        const response = result.response;
        return response.text();
      } catch (error)
      {
        console.error("Error calling Gemini API:", error);
        return "Error: Could not generate content.";
      }
    }

    document.getElementById("analyzeBtn").onclick = async function ()
    {

      const symptomInput = document.getElementById("symptomSearch").value;
      const outputDiv = document.getElementById("diagnosis");

      if (!symptomInput.trim())
      {
        outputDiv.innerHTML = "Please enter symptoms first ğŸ©º";
        return;
      }

      outputDiv.innerHTML = "â³ Analyzing symptoms with Gemini AI...";

      var ai_input = symptomInput + "what medicine should I take?";

      const reply = await get_ai_response(ai_input);
      outputDiv.innerHTML = `<strong>Results:</strong><br/>${reply}`;
    };

  </script>
</head>
<body>
  <div class="float-bg" aria-hidden="true">
    <div class="particle p1"></div>
    <div class="particle p2"></div>
    <div class="particle p3"></div>
    <div class="particle p4"></div>
  </div>

  <div class="container">
    <header class="top-header">
      <div class="logo" role="banner" aria-label="QuackHub Healthcare logo">
        <div class="mark">ğŸ¦†</div>
        <div class="logo-text">
          <div class="title">QAAuckHUB Healthcare</div>
          <div class="sub">Just Call the DUCKtor Already</div>
        </div>
      </div>
      <div class="team-tag">Team QAAck - Quentin, Allen, Vihaanâœ¨</div>
    </header>

    <main class="grid" role="main">
      <section class="card left-card">
        <h3>ğŸ©º Symptoms & Patient Information</h3>

        <div class="symptom-block">
          <label for="symptomSearch">ğŸ” Symptoms (select multiple)</label>
          <div id="symptomInput" class="multi-select" tabindex="0" aria-haspopup="listbox" aria-expanded="false" role="combobox" aria-controls="symptomList">
            <span id="chipArea" class="chip-area" aria-live="polite"></span>
            <input id="symptomSearch" class="symptom-search" type="text" placeholder="Type to filter symptoms or add custom..." />
          </div>

          <div class="dropdown">
            <div id="symptomList" class="list" role="listbox" aria-label="Symptoms list" hidden></div>
          </div>
          <div class="help">ğŸ’¡ Start typing to filter symptoms or press Enter to add custom symptoms</div>
        </div>

        <div class="form-row">
          <div class="small">
            <label for="age">ğŸ‘¤ Age</label>
            <input id="age" type="number" min="0" max="120" placeholder="e.g., 35" />
          </div>
          <div class="small">
            <label for="sex">âš§ Sex</label>
            <select id="sex">
              <option value="">Prefer not to say</option>
              <option value="male">Male</option>
              <option value="female">Female</option>
              <option value="other">Other</option>
            </select>
          </div>
          <div class="small">
            <label for="weight">âš–ï¸ Weight (lbs)</label>
            <input id="weight" type="number" min="0" placeholder="optional" />
          </div>
          <div class="small">
            <label for="height">ğŸ“ Height (inches)</label>
            <input id="height" type="number" min="0" placeholder="optional" />
          </div>
        </div>

        <div class="form-row">
          <div style="flex: 2">
            <label for="duration">â° Symptom Duration</label>
            <select id="duration">
              <option value="">Select duration</option>
              <option value="less_than_hour">Less than 1 hour</option>
              <option value="few_hours">Few hours</option>
              <option value="1_day">1 day</option>
              <option value="few_days">2-3 days</option>
              <option value="week">About a week</option>
              <option value="weeks">Several weeks</option>
              <option value="months">Months</option>
            </select>
          </div>
          <div style="flex: 2">
            <label for="severity">ğŸŒ¡ï¸ Pain/Discomfort Level (1-10)</label>
            <input id="severity" type="number" min="1" max="10" placeholder="1=mild, 10=severe" />
          </div>
        </div>

        <div class="actions">
          <button id="analyzeBtn" class="btn">ğŸ” Analyze with AI</button>
          <button id="resetBtn" class="btn secondary">ğŸ”„ Reset</button>
          <button id="locationBtn" class="btn secondary">ğŸ“ Get Location</button>
        </div>

        <div class="help small-help">
          âš ï¸ <strong>Important:</strong> This is an AI-assisted tool for informational purposes only. 
          Always consult qualified healthcare professionals for medical advice, diagnosis, or treatment.
        </div>
      </section>

      <aside class="card right-col" aria-label="Results">
        <div class="result-title">
          <div>
            <div class="muted-small">ğŸ¤– AI Analysis Results</div>
            <div class="result-main">Diagnosis & Emergency Assessment</div>
          </div>
          <div class="muted-small" id="lastUpdated">â€”</div>
        </div>

        <div id="emergencyBanner" class="danger hidden" role="alert">
          <div class="danger-title">ğŸš¨ EMERGENCY CARE RECOMMENDED</div>
          <div class="danger-sub">Seek immediate emergency medical attention</div>
          <div class="emergency-actions">
            <button id="call911Btn" class="btn danger">ğŸ“ Call 911</button>
            <button id="findERBtn" class="btn secondary">ğŸ¥ Find Nearest ER</button>
          </div>
        </div>

        <div id="resultBox" class="result-box" aria-live="polite">
          <div id="loadingIndicator" class="loading hidden">
            <div class="spinner"></div>
          </div>
          
          <div id="analysisResults">
            <div class="result-section">
              <h4>ğŸ©º Potential Diagnosis</h4>
              <div id="diagnosis" class="result-text">Click "Analyze with AI" to get started! ğŸš€</div>
            </div>
          </div>

          <div id="locationServices" class="location-services hidden">
            <h4>ğŸ“ Nearby Healthcare Services</h4>
            <div id="nearbyProviders"></div>
          </div>
        </div>

        <footer class="note">ğŸ”’ All data is processed securely. No personal information is stored.</footer>
      </aside>
    </main>
  </div>
</body>
</html>